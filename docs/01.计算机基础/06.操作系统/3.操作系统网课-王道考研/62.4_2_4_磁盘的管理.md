---
title: 4_2_4_磁盘的管理
date: 2023-05-15 16:30:25
permalink: /ComputerOS/cskaoyan/disk-management
categories:
  - 计算机基础
  - 操作系统
  - 操作系统网课-王道考研
tags:
  - 
feed:
  enable: true
description: 各位同学大家好，在这个小节中我们会介绍磁盘管理相关的几个很简单的知识点，‍‍我们首先会介绍什么是磁盘初始化，磁盘初始化的过程中需要做些什么
---
# 4.2_4_磁盘的管理

　　‍各位同学大家好，在这个小节中我们会介绍磁盘管理相关的几个很简单的知识点，‍‍我们首先会介绍什么是磁盘初始化，磁盘初始化的过程中需要做些什么
<!-- more -->
　　另外我们会介绍引导快或者说起起始块的概念

　　最后我们会介绍对于磁盘坏块的一个管理，

　　![](https://image.peterjxl.com/blog/image-20221010224808-xbg54pu.png)

　　‍

　　‍

## 磁盘初始化

　　首先来看一下什么是磁盘初始化。‍‍我们的磁盘刚被制造出来的时候，其实是只被划分成了一个的磁道

　　![](https://image.peterjxl.com/blog/image-20221010224834-8qptp0z.png)

　　‍

　　‍

　　在磁盘正式出场之前，还需要进行一个叫做低级格式化或者叫物理格式化的过程，‍‍这个过程一个划分扇区的过程

　　![](https://image.peterjxl.com/blog/image-20221010224904-7x40n4t.png)

　　‍

　　‍

　　一个扇区可以分为头、‍‍尾还有数据区域这样三个部分，每个扇区的数据区域所能存放的数据数量都是相同的，比如说可以存放512个字节

　　所以咱们之前所聊到的一个扇区可以存放的数据的大小，其实指的是数据区域可以存放的大小，‍‍像头和尾这两个部分可以做什么？‍‍还记不记得咱们在讲文件的物理结构的时候，‍‍讲过一种链式结构，也就是把文件的那些数据块用链接的方式把它连起来。‍‍前一个数据块指向下一个数据块的指针，其实就可以保存在尾部这个部分。‍‍也就是说这个链接指针并不需要占用数据区域，这样的话可以方便操作系统管理。‍‍

　　另外管理扇区需所需要的那些数据结构一般也是放在头和尾的位置。比如说像扇区校验码，‍‍大家在计组当中应该也学过基偶校验、还有循环冗余校验码等等，‍‍这些校验码可以用来检查数据区域当中存放的这些数据是否发生了错误，‍‍这样的话可以大幅度的提高磁盘存储数据的一个可靠性。‍‍

　　总之一个扇区由头数据区域为三个部分组成，‍‍扇区的划分其实是在出厂之前低级格式化，也就物理格式化的时候进行的

　　‍

　　‍

　　在我们正式开始使用磁盘之前，还需要对磁盘进行逻辑上的分区，‍‍每个分区由若干个相邻的柱面组成这所谓的分区，其实就是我们平时熟悉的c盘，‍‍d盘，e盘

　　![](https://image.peterjxl.com/blog/image-20221010225053-4pa8ci0.png)

　　‍

　　‍

　　‍

　　在划分了分区之后，需要进行下一步叫做逻辑格式化。‍‍逻辑格式化所做的事情主要就是创建文件系统，包括要创建这些根目录文件，‍‍并且要把那些用于存储空间管理的数据结构也进行初始化，比如说像咱们之前学过的位示图，空闲分区表等等，‍‍也是在逻辑格式化这个步骤当中给建立的，这是磁盘初始化的时候需要做的几个事情。‍‍

　　![](https://image.peterjxl.com/blog/image-20221010225124-o1oe5cz.png)

　　‍

　　‍

## 引导块

　　接下来我们来看一下什么是磁盘的引导块，‍‍在我们的磁盘完成了物理格式化，还有磁盘分区和逻辑格式化之后，‍‍我们就可以把操作系统的那些相关数据把它写到磁盘中了，‍‍也就是我们所谓的自己安装操作系统的一个过程。‍‍

　　在计算机开机启动的时候，其实是需要进行一系列的初始化工作的，包括初始化CPU、初始化内存，‍‍然后初始化像寄存器之类的一些硬件部件，‍‍但是这个初始化的过程需要执行所谓的初始化程序也叫自举程序。‍‍一般来说自主程序是存放在ROM，也就是只读存储器当中的，‍‍而ROM中的数据是在出场的时候就已经写到了 ROM当中，并且以后就不能再修改。‍‍

　　一般来说ROM是在出场的时候就直接集成在了我们的电脑主板上，‍‍也就是说计算机开机的时候，它首先会读取ROM当中的这些程序，并且执行这些程序来完成初始化的工作。‍‍但是我们来思考一下，我们把自己程序放在ROM当中会有什么问题呢？‍‍假设我们的自己程序需要更新的话，那么就会很不方便，因为ROM当中的数据是无法更改的，‍‍但是由于自举程序本身又比较复杂，所以我们不太可能保证自己程序相关的数据永远不改变。‍‍这个问题怎么解决呢？‍‍

　　![](https://image.peterjxl.com/blog/image-20221010225303-3b7hnyr.png)

　　‍

　　‍

　　现在的操作系统一般是指在ROM当中存放很小的一个自举装入程序，‍‍而完整的自举程序会存放在磁盘的启动块，也就是这儿所说的引导块，‍‍或者叫启动分区上，‍‍比如说存放在c盘的这几个盘块上，那么这些区域就可以称作启动分区，或者叫引导块启动块。‍‍

　　启动块规定必须在磁盘的固定位置，当计算机开机的时候，首先会执行ROM中的自举装入程序，‍‍在执行自己装入程序的过程当中， CPU就可以知道‍‍接下来需要执行的自举程序，是存放在硬盘当中的哪个位置的，通过自举装入程序的引导，‍‍CPU就可以从磁盘中读取完整的字符程序，这样的话就可以完成初始化。‍‍

　　自举装入程序的复杂度不高很小，所以其实是可以保证自举装入程序是不会出错的，不需要更改的。‍‍

　　而自举程序需要更改的话，我们就把自举程序放在磁盘的固定位置，‍‍这样的话当自举程序需要更新的时候，就只需要重新把这些引导块当中的数据把它重写一下，更新一下就可以了。‍‍

　　所以这种方案带来的好处就是自己程序的更新会变得很方便，一般来说拥有启动分区或者叫引导块启动块的‍‍逻辑磁盘就被称为启动磁盘或者叫系统磁盘。像平时咱们‍‍很熟悉的c盘就是系统磁盘，也就是说其实c盘的某一个固定位置是装了我们的自举程序的，‍‍这是引导块的作用。‍‍

　　![](https://image.peterjxl.com/blog/image-20221010225437-dqsvlzr.png)

　　‍

　　‍

## 磁盘的坏块

　　接下来我们再来看一下对磁盘的坏块应该进行什么样的管理，所谓的坏块就是指那些坏了的‍‍无法正常使用的扇区就是坏块，‍‍这属于一种硬件故障，操作系统是无法通过软件的方式把它进行修复的。‍‍所以为了防止我们错误的使用这些坏块，我们就必须把这些坏块给标记出来。‍‍

　　在简单的磁盘系统当中，可以在进行逻辑格式化的时候，来标明哪些磁盘块是坏块，比如说我们可以把它在FAT也‍‍也就是文件分配表上进行一个标注，‍‍标记为坏块的这些块之后，不再分配给任何一个文件就可以了。‍‍

　　由于操作系统在对存储空间进行管理的时候，肯定是需要读取文件分配表的内容的，‍‍而哪些块是坏块是记录在文件分配表当中的，因此采用这种方式的话，‍‍对这个操作系统是不透明的。‍‍

　　而对于复杂的磁盘系统来说，磁盘控制器这样的一个磁盘内部的硬件部件会负责维护一个叫做坏块链的链表，‍‍顾名思义就是把这些坏块用某种方式把它们链接起来，‍‍在磁盘出厂的时候，其实就有可能已经有一些坏块了，所以在出场之前就会对这些坏块进行一个检查，‍‍在低级格式化也就物理格式化的时候，就需要把这个坏块链进行初始化。‍‍

　　另外磁盘控制器还会保留一些好的备用扇区，用来替换这些坏块。‍‍比如说此时操作系统想要使用这一个本来已经坏掉的块，那么在硬件的层次，‍‍磁盘控制器这个硬件部件就会用其中的某一个好的这种备用块‍‍来替换这个块块，但是这个过程对于操作系统是透明的，操作系统是不可知的，‍‍这种方案也被称为扇区备用，这是对磁盘的坏块进行管理的两种方法。‍‍

　　![](https://image.peterjxl.com/blog/image-20221011071336-1jv76fe.png)

　　‍

## 小结

　　那么这个小节我们介绍了磁盘的初始化需要做一些什么事情，分为低级格式化、磁盘分区，还有逻辑格式化这样三个步骤，大家需要理解，并且‍‍各个步骤需要做的是一些什么事情，‍‍

　　之后我们介绍什么是引导块，引导块主要是要用于存放自己程序的，‍‍在开机的时候一定需要运行自己程序才可以完成初始化的过程。

　　最后我们介绍了两种坏块的管理方式，‍‍这个小节的内容都不难理解，大家只需要有个印象，能应付选择题就可以了。

　　‍

　　![](https://image.peterjxl.com/blog/image-20221011071410-p4bnucm.png)

　　‍
