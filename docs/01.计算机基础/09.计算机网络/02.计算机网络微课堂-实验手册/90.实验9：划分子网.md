---
title: 实验9：划分子网
date: 2022-10-09 19:01:52
permalink: /Network/lab9-IPv4-Subnet/
categories:
  - 计算机基础
  - 计算机网络
  - 计算机网络微课堂-实验手册
tags:
  - 
feed:
  enable: true
description: 下面我们来进行一个仿真实验，本仿真实验的目的在于学习划分子网的方法以及验证子网掩码的作用。
---



# 90.实验9：划分子网

下面我们来进行一个仿真实验，本仿真实验的目的在于学习划分子网的方法以及验证子网掩码的作用。

‍<!-- more -->

‍

我们首先来构建一个这样的网络拓扑，我们需要 4 台主机，2 台交换机，我们选择自动连线的类型让他们互联起来，为了使指示灯从橙色的快速变成绿色，我们快速切换右下角的实时和切换按钮，接下来需要给这 4 个主机分别设置 1 个 IP 地址和子网掩码，我已经将每台主机的 IP 地址和子网掩码标注在了他们旁边，我们按照标注的值进行设置即可，我们依次来进行设置，192.168.0.1，子网掩码是三个 255 一个 0，这是他默认的子网掩码

下面这台主机 192.168.0.2 多少掩码，也就三个 255 一个 0。右上方的这台主机，192.168.0.65，子网掩码三个 255 一个 0，最后这台主机 192.168.0.66，子网掩码三个 252 一个 0，现在这 4 台主机之间可以相互通信吗？答案是这 4 台主机可以相互通信，因为通过给定的 IP 地址和子网掩码，我们可以知道这四台主机是在同一个网络上的，具体分析如下，我们通过给定的 IP 地址的第一个数，第一个 10 进制数也就是 192，我们就可以看出这是一个 C 类的 IP 地址，而给定的子网掩码是三个 255 一个 0，这是 C 类的默认子网掩码，相当于没有划分子网，因此在给定的 IP 地址中，前三个字节就是网络号部分，最后一个字节就是主机部分，而我们看到这 4 台主机的 IP 地址的前三个字节，也就是前三个数都相等，也就是 192.168.0 。因此我们可以判定这 4 个主机他们在同 1 个网络上。

也可以这样来判断，将每个主机的 IP 地址和它自己的子网掩码相与，我们会得到网络号部分以及被清零的主机号部分，其实得到的结果就是主机所在的网络的网络号。同理其他的主机都是这么操作，我们会得到 4 个网络号，如果这 4 个网络号相同，那就证明这 4 台主机在同 1 个网络上，那么他们之间就可以相互通信。

我们可以看一下上面这台主机 192.168.0.1 和 255.255.255.0，相遇的结果是 192.168.0.0。同理下面这台主机它的 IP 地址和子网掩码相余，结果也是 192.168.0.0，右边这两台也是同样的结果，这就表明了他们就在同一个网络上，他们是可以直接相互通信的。

​![](https://image.peterjxl.com/blog/image-20220102105938-wolnvpk.png)​

下面我们就来验证一下这 4 台主机之间可以相互通信，我们用左下角的这台主机分别去 ping 一下它上面的这台，还有它右边这两台主机，它是否可以 ping 通。我们到命令提示符。我们现在是下面这台主机的命令行，我们来 ping 一下上面这台主机，也就是 ping 192.168.0.1。我们看到一次收到响应回来了，有 4 个响应回来，下面这一台可以 ping 通它上面这一台，
我们再 ping 一下它右上方的这一台，也就是 192.18.0.65。我们看到也接收到响应了。

那么我们最后再 ping 一下它右下角的这一台 192.168.0.66。这样我们可以看到这 4 台主机应该是可以互相通信的。

---

下面我们将各个主机的子网掩码更改一下，假如说我们给它更改成三个 255，然后最后一个数值是 192，我这里先把它标注上了。下面我们就来实际的改一下左上这台主机 IP 地址这个地方改成 192，我们把它复制一下，下面这台主机 IP 配置，然后把这地方粘贴一下。右上方的主机把它的子网掩码也给它改掉。最后右下方这台主机。

现在请您思考一下，这 4 台主机之间是否还能进行相互通信？答案是左边这两台主机之间可以相互通信，右边这两个主机之间可以相互通信，但是左边和右边它们不能相互通信，这是因为左边这两台主机被划分到了一个子网，而右边这两台主机被划分到了另一个子网，我们可以将这 4 台主机的 IP 地址与他们自己的子网掩码进行相与，然后得到网络号，我们会发现左边这两台主机，他们会得到相同的网络号，也就是 192.168.0.0，说明这两台主机在同一个网络上，而右边这两台主机也可以得到一个相同的网络号，这个网络号是 192.168.0.64，这表明右边这两个主机也在一个同样的网络上，这个网络就是 192.168.0.64，这样左边和右边他们就不在同一个网络。

我们来验证一下是不是这样的情况。我们先用左下面这台主机去 ping 一下上面这台主机，PING 192.168.0.1，我们可以看到可以 ping 通，这是因为他们在同一个子网当中，我们再用下面这台主机去 ping 一下右上角的主机 192.168.0.65。PING192.168.0.65 第一次请求超时，第二次请求超时，第三次也超时了了，第 4 次也超时了。

同理我们用现在左下角这台主机去 ping 一下右下角这台主机，因为他们不在同一个子网里面，应该也是 ping 不通的。现在我们用右边的上面这台主机，也就是我们用右侧上方的这台主机，我们用它来 ping 一下，和它属于同一个子网的下面这台主机应该是能够 ping 通的，我们看一看是不是这样子。

ping 192.168.0.66，我们可以看到收到 4 个响应，这是 ping 得通的，这样就证明了我们刚才的分析，也就是说左边两个主机是同一个子网，它们之间可以通信，右边两个主机是同一个子网，它们两个可以加相互通信，但是左右两边他们不能通信，为了使左右两个网络能够相互通信，我们就需要用到第三层的网络互联设备，也就是路由器。

​![](https://image.peterjxl.com/blog/image-20220102113425-hr3divb.png)​

---

我们拖动一台普通的路由器到逻辑工作空间，然后将之前两个交换机之间的连线给它们断开，我们选择这里的删除。然后把鼠标状态切换回选择状态，然后我们在这里选择自动连接类型，将两个交换机分别连接到这个路由器上，我们可以看到此时路由器的接口以及交换机的接口都是红色指示灯，这是由于路由器的这两个端口还没打开，我们先将它们打开，然后再选择它的端口 1 把它打开。这个时候这儿就变成了绿色指示灯，但是这样还是橙色的，我们切换几下实时和仿真按钮，这个状态指示灯全部变成了绿色，现在需要为路由器的端口 0 和端口 1 各设置一个 IP 地址和子网掩码。

​![](https://image.peterjxl.com/blog/image-20220102113910-63m9exf.png)​

由于端口 0 与它左边的这两台主机属于同一个网络，因此它们应该有相同的子网掩码以及相同的网络号，只有主机号部分是不同的。同理，路由器的端口 1 和它右侧的这两台主机，它们是同一个网络里面的，所以他们的子网掩码应该相等，并且网络号也应该相等，而主机号应该不相等。我们在理论课程中曾经介绍过分类网快速划分子网的方法，现在我们在这里再次的使用一下这种方法，我们通过子网掩码，最后的 10 进制数 192 我们就可以看到第 4 次增长的增量，也就是第 4 个 10 进制数的增量应该用 256-192=64，这样的话我们就可以立刻得出子网地址，因为这是一个 C 类网化分子网，所以它前三个字节的都是不动的，也就是 192.168.0 就是固定不动的，那么它从 0 开始增长，每次增长步长为 64，也就是增量为 64，那么第一个子网是 192.168.0.0。

第二个也就是在它基础上增加 64，那么也就是 192.168.0.64，以此类推，一直到这个增长到 192。这样我们就把通过子网掩码，我们可以看出来就画成了 4 个子网，每一列就是 1 个子网。那么这是每个子网的子网号，那么在每个子网里面最小可分配给主机的 IP 地址是比它子网号，也就是比子网地址大一的地址。那么第一个值也就是 192.168.0.0，这个值往上的最小可分配给主机的 IP 地址就是 192.168.0.1，那它的第一个子网的广播地址应该比它后面子网小一，后面子网的网络地址是 192.168.0.64，因此第一个子网它的广播地址就是 192.168.0.63，另外在子网上面最大的主机，它的地址应该比它的广播地址再小一，所以应该就是 192.168.0.62。

后面的大家可以依次按这个规律去分析出来，这就是一个使用这样的一个子网掩码，对 C 网 192.168.0 这样的一个 C 类网进行划分子网的具体的细节。我们在这里看到我们左侧的两个主机，其实他们根据他们的 IP 地址，我们在这儿可以找到，他们是被划分到 192.168.0.0 子网里面去了，并且上面主机它的 IP 地址是最小可分配的 IP，也就是 192.168.0.1，而下面的这个是他随后紧接着他后面的那个地址就是 0.2，那么我们现在就可以给路由器它的接口分配一个 IP 地址，假如说我们就分配，因为它现在也属于子网 192.168.0.0 上面，所以我们给他分配一个其实是可以随意分的，1、2 这两个不能分，一直到 62，那么我们就取 62 这个值分给他。那就是 192.168.0.62，那子网掩码这里它会默认给你一个，但是实际上我们现在的子网掩码是 3 个 25，然后 192，所以把这里改为 192。

​![](https://image.peterjxl.com/blog/image-20220102113719-ilhacgk.png)​

同理我们可以看到右边这两个主机，其实我们是把它划归在了第二个子网上，也就是 192.168.0.64 这个子网上，而右上角的主机刚好我们用的是子网上的最小的可分配给主机的 IP 地址，然后下面这台是紧随其后就 66，那么同理我们需要给路由器的端口 1 的分配，一个在 192.168.0.64 这个子网上的一个可用的 IP，那么这里面我们选用最大的 IP，也就是 192.168.0.126，那么它会自动给你一个子网掩码、这次给的是对的，我们就无需修改了

​![](https://image.peterjxl.com/blog/image-20220102113729-l5uzqm2.png)​

最后不要忘记了，给每一台主机都要设置一个默认网关，那么左边这两台主机给它设置默认网关，其实它们的默认网关就是路由器，右边这两个主机的默认网关也是路由器，只不过作为左边这两台主机，应该给他指定的默认网关的 IP 地址是路由器的端口 0 的 IP，而右边这两台主机的默认网关，它的 IP 地址应该设置路由器的端口 1 的 IP。那么我们就来设置一下，我们刚才说了路由器的端口 0，它的 IP 地址是 192.168.0.62，也就是子网 0 上的 192.168.0.0，子网上面的最大的 IP 地址，就是这样的，192.168.0.62，好我们把它复制一下，这样的话下面这台主机他的默认网关也是这个地址。

那么我们再来给右边两台主机设置一下默认网关，那么我们刚才说了右面这两台主机，包括路由器的端口 1，它们都属于子网 192.168.0.64 这个子网上的，那么并且我们刚才给端口 1 分配了子网 192.168.0.64，上面的最大主机 IP 地址也就 126，192.168.0.126，所以我们这里面要给这两台主机指定的一个默认网关，就是这个 IP 地址，192.168.0.126，我们复制一下，下面这个主机也同样的这样给它配置上。

那么按道理来说，现在这 4 台主机可以左右相互通信了，之前没有路由器的时候，如果配置这样的子网掩码只能左侧两个之间通信，右侧两个之间通信，左右不能通。现在我们相当于用路由器把左右两个网络给它互联起来了，并且左右的这些主机都分别设置了默认的网关。他们现在应该可以通信了，我们来验证一下，我们用左边这台主机来 ping 一下，先 ping 在下面，就是没有这个路由器存在，按道理也应该 ping 得通，我们来看一下 PING 然后 192.168.0.2，确实可以 ping通，那么我们现在再用左上方主机来 ping 一下它右侧的 192.168.0.65 的这台主机，我们看一下能不能 ping 通。我们现在开始 ping 第一次请求超时了，第 2 次就 ping 通了，然后第 3 次第 4 次都是 ping 通的，那说明他们是可以通信的。为什么第一次存在这样的一个超时，这里面有多次使用 ARP 广播请求的这样的一个过程在里面，所以第一次是会超时的，之后的话就不会再发动这个 ARP 广播请求了，因此 ping 应用程序就不会觉得超时了。

这样的话我们就验证了左上方的和右边的右上方的可以通自然和它下面这个也能通：

```
C:\>ping 192.168.0.66

Pinging 192.168.0.66 with 32 bytes of data:

Request timed out.
Reply from 192.168.0.66: bytes=32 time<1ms TTL=127
Reply from 192.168.0.66: bytes=32 time=5ms TTL=127
Reply from 192.168.0.66: bytes=32 time<1ms TTL=127

Ping statistics for 192.168.0.66:
    Packets: Sent = 4, Received = 3, Lost = 1 (25% loss),
Approximate round trip times in milli-seconds:
    Minimum = 0ms, Maximum = 5ms, Average = 1ms
```

‍

‍

我们来试一下。66，那么仍然可以看到第一次 ping 的时候会有一个超时，就是我们刚才说的 ARP 的事情。之后连续 3 次都是没有超时的通了，那么我们现在再重新 ping 一次，他应该很快的这 4 次的都不会超时。

本次实验就进行到这里。下面给您布置一个练习，我们将左边这两台主机以及路由器的端口 0 划归到这个网上面，也就是 192.168.0.128，将右边这两台主机和路由器的端口 1 给它划归到这样的一个子网上面，也就是 192.168.0.192 这个子网上，请您给这 4 个主机以及路由器的 2 个端口重新分配 IP 地址，以及设置子网掩码，那么目的是使得他们之间这 4 个主机之间可以相互通信，请您特别需要注意的时候，配置完了以后，不要忘记给每个主机指定他的默认网关。

‍
