---
title: 6.5 文件传送协议FTP
date: 2023-11-16 15:52:28
permalink: /Network/application-layer/6.5
categories:
  - 计算机基础
  - 计算机网络
  - 计算机网络微课堂-B站教书匠
tags:
  - 
feed:
  enable: true
description: 本节课我们介绍文件传送协议FTP。
---



# 650.6.5：文件传送协议 FTP

本节课我们介绍文件传送协议 FTP：

<!-- more -->


* 将某台计算机中的文件通过网络传送到可能相距很远的另一台计算机中，是一项基本的网络应用，即文件传送
* 文件传送协议 FTP 是因特网上使用的最广泛的文件传送协议

  * FTP 提供交互式的访问，允许客户指明文件的类型与格式，例如指明是否使用 ASCII，并允许文件具有存取权限。比如访问文件的用户必须经过授权并输入有效的口令
  * FTP 屏蔽了各计算机系统的细节，因而适用于在异构网络中任意计算机之间的传送文件
* 在因特网发展的早期阶段，用 FTP 传送文件，约占整个因特网的通信量的 1/3，而由电子邮件和域名系统所产生的通信量还要小于 FTP 所产生的通信量，只是到了 1995 年万维网的通信量才首次超过了 FTP

接下来我们举例说明 FTP 的应用。如图所示 FTP 采用客户服务器方式，因特网上的 FTP 客户计算机可将各种类型的文件上传到 FTP 服务器计算机，FTP 客户计算机也可以从 FTP 服务器计算机下载文件，根据应用需求的不同，FTP 服务器可能需要一台高性能高可靠性的服务器计算机，也可能只需要一台普通的个人计算机即可。

例如本例也可以采用普通的个人计算机作为 FTP 服务器计算机，为了简单起见，我们假设 FTP 客户计算机与 FTP 服务器计算机处于同一个局域网中，我们在 FTP 服务器计算机中创建 FTP 服务器，可以使用第三方的 FTP 服务器软件，也可以使用操作系统自带的 FTP 服务器软件，例如我们可以在 Windows 系统中使用其自带的 FTP 服务器功能，创建一个 FTP 服务器站点，具体方法比较简单，请同学们在网上自行查阅。

假设这是我所创建的 FTP 服务器的 IP 地址，我们可以在 FTP 客户计算机中需要浏览器软件，通过该地址来访问 FTP 服务器，需要注意的是这里使用的是文件传送协议 FTP，而不是浏览器最常用的超文本传送协议 HTTP。

​![](https://image.peterjxl.com/blog/image-20211219215057-lgn9xnc.png)​

我们也可以在 FTP 客户计算机中需要 Windows 系统自带的命令行工具，通过该地址来访问 FTP 服务器，例如这是连接 FTP 服务器，采用匿名登录，因此无需输入密码，登录成功后可以列出 FTP 服务器当前目录下的所有文件和文件夹，可从 FTP 服务器下载文件，也可向 FTP 服务器上传文件，命令行方式需要用户记住相关命令，这对普通用户而言并不友好，因此大多数用户在 FTP 客户计算机上使用第三方的 FTP 客户工具软件，通过友好的用户界面来完成 FTP 服务器的登录以及文件的上传和下载。

​![](https://image.peterjxl.com/blog/image-20211219215200-r8dswh0.png)​

FTP 的常见用途是在计算机之间传输文件，尤其是用于批量传输文件，FTP 的另一个常见用途是让网站设计者将构成网站内容的大量文件，批量上传到他们的 Web 服务器。

---

接下来我们介绍 FTP 的基本工作原理，如图所示 FTP 服务器监听熟知端口号 21，FTP 客户随机选择一个临时端口号，与其建立 TCP 连接，这条 TCP 连接用于 FTP 客户与服务器之间传送 FTP 的相关控制命令，也就是说这条 TCP 连接是 FTP 客户与服务器之间的命令通道，当有数据要传输时，FTP 客户通过命令通道告知 FTP 服务器来与自己的另一个临时端口号建立 TCP 连接，即建立数据通道，这是 FTP 客户随机选择的另一个端口号，FTP 服务器使用自己的熟知端口号 20 与其建立 TCP 连接，这条 TCP 连接用于 FTP 客户与服务器之间传送文件，也就是说这条 TCP 连接是 FTP 客户与服务器之间的数据通道。

由于在建立数据通道时，FTP 服务器主动连接 FTP 客户，因此称为主动模式，需要注意的是控制连接在整个会话期间一直保持打开，用于传送 FTP 相关的控制命令，而数据连接用于文件传输，在每次文件传输时才建立，传输结束就关闭。

再来看被动模式，对于 FTP 客户与服务器之间命令通道的建立，它与主动模式并没有什么。不同之处，在于当有数据要传输时，FTP 客户通过命令通道通知 FTP 服务器开启某个协商好的临时端口，被动等待来自 FTP 客户的 TCP 连接，以建立数据通道，这是 FTP 服务器使用的与 FTP 客户协商好的临时端口号，这是 FTP 客户随机选择的另一个端口号。FTP 客户发起与 FTP 服务器的 TCP 连接，以建立数据通道，由于在建立数据通道时，FTP 服务器被动等待 FTP 客户的连接，因此称为被动模式。

​![](https://image.peterjxl.com/blog/image-20211219215455-00p0oy9.png)​

---

最后我们来做两个相关的练习题，这是计算机专业考研全国统考计算机网络部分 2009 年的题 40，答案是选项 A

FTP 客户和服务器之间要建立以下两个并行的 TCP 连接。

一个是控制连接，在整个会话期间一直保持打开，用于传送 FTP 相关控制命令。

另一个是数据连接用于文件传输，在每次文件传输时才建立，传输结束就关闭。

​![](https://image.peterjxl.com/blog/image-20211219215628-wnmh2ih.png)​

这是 2017 年的题 40，答案是选项 C。

FTP 客户和服务器之间要建立控制连接和数据连接，这两个并行的 TCP 连接，控制连接在整个会话期间都保持打开状态，而数据连接在每次文件传输时才建立，传输结束就关闭。默认情况下，FTP 使用 TCP21 号端口进行控制连接，TCP20 号端口进行数据连接，但是是否使用 TCP20 号端口建立数据连接与传输模式有关，主动方式使用 TCP20 号端口，而被动方式由服务器和客户端自行协商决定。

​![](https://image.peterjxl.com/blog/image-20211219215724-br40akq.png)​

本节课的内容小结如下：

​![](https://image.peterjxl.com/blog/image-20211219215736-s04tz24.png)​

‍
