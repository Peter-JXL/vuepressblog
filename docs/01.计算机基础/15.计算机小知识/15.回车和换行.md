---
title: 回车和换行
date: 2022-12-10 22:36:41
permalink: /literacy/character-encoding-CR-LF/
categories:
  - 计算机基础
  - 计算机小知识
tags:
  - 
feed:
  enable: true
description: 在学计算机的时候，总是会遇到回车和换行，但一直没去深究；在学习字符编码相关知识的时候，觉得得深入去搞懂下，除了编码，在我们日常工作中也是经常会遇到的。
---

# 15.回车和换行

在学计算机的时候，总是会遇到回车和换行，但一直没去深究；在学习字符编码相关知识的时候，觉得得深入去搞懂下，除了编码，在我们日常工作中也是经常会遇到的。

<!-- more -->

因此去网上查阅了相关博客，有了今天这篇文章。我们先从回车和换行的起源说起

‍

## 起源：打字机

在计算机还没有出现之前，有一种叫做**电传打字机**（Teletype Model 33，Linux/Unix 下的 tty 概念也来自于此）的玩意，每秒钟可以打 10 个字符。但是它有一个问题，就是打完一行换行的时候，要用去 0.2 秒（注：估计是从打字机的最右边回到最左边的机械运动 所需要的时间），正好可以打两个字符。要是在这 0.2 秒里面，又有新的字符传过来，那么这个字符将丢失。

于是，研制人员想了个办法解决这个问题，就是在**每行后面加两个表示结束的字符**。

一个叫做 “**回车（Carriage Return）** ”，告诉打字机把打印头定位在左边界；注意，并没有移动到下一行的意思。

另一个叫做 “**换行（Line Feed）** ”，告诉打字机把纸向下移一行。

这就是 “换行” 和 “回车” 的来历，从它们的英语名字上也可以看出一二。

也就是回车和换行之后，我们才是在下一行的最开始，继续打印字符。

‍

这里引用一些便于理解的说明（阮一峰大佬博客的评论）：

> **attilax** **说：**
>
> 这个说法我有点儿补充::"回车"（carriage return）和"换行"（line feed） 是来源机械英文打字机的...电传打字机那个是后来的...
>
> "车"指的是纸车,带着纸一起左右移动的模块。。。 当开始打第一个字之前，要把纸车拉到最右边，上紧弹簧。。随着打字， 弹簧把纸车拉回去..每当打完一行后，纸车就完全收回去了...所以叫回车.. 换行的概念就是 :: 打字机左边有个"把手 ",往下 扳动一下,纸会上移一行..

‍

‍

‍

‍

‍

## 继承：计算机

后来，计算机发明了，**这两个概念也就被搬到了计算机上**。在 ASCII 码里：

* **CR** 用符号 `\r`​ 表示，十进制 ASCII 代码是 13, 十六进制代码为 0x0D；
* **LF** 使用 `\n`​ 符号表示，ASCII 代码是 10, 十六制为 0x0A；

‍

## 分歧：一个字符还是两个字符

**那时，存储器很贵，一些科学家认为在每行结尾加两个字符太浪费了，加一个就可以**。于是，就出现了分歧。

* Unix 系统里，每行结尾只有 “LF”，即”`\n`​”
* Windows 系统里面，每行结尾是 “LFCR”，即 “`\n\r`​”
* Mac 系统里，每行结尾是 “CR”，即”`\r`​”

‍

## 分歧的后果

在 Windows 下保存的文件，默认就是 CRLF 作为结尾的。

而在 Linux 下保存的文件，默认是以 LF 作为结尾的。

因此，Unix/Mac 系统下的文件在 Windows 里打开的话，所有文字会变成一行；

而 Windows 里的文件在 Unix/Mac 下打开的话，在每行的结尾可能会多出一个 `^M`​ 符号。

‍

这种换行符，还可能导致程序错误。例如，你在 Windows 下编写了一个 shell 程序，其是以 CRLF 作为结尾；而如果你直接上传到 Linux 下执行，Linux 会报错，因为换行符不同。

**在不同平台间使用 FTP 软件传送文件时**

* 在 **ascii 文本模式**传输模式下，一些 FTP 客户端程序会自动对换行格式进行转换,经过这种传输的文件字节数可能会发生变化。

  ```shell
  git add .
  warning: LF will be replaced by CRLF in package-lock.json.
  The file will have its original line endings in your working directory
  ```
* 如果你不想 ftp 修改原文件，可以使用 **bin 模式 (二进制模式)**  传输文本。

‍

‍

> 注：可以在 Linux 下用 dos2unix 命令和 unix2dos 命令，来转换每行的结尾。
>
> ‍
>
> 在 Windows 下，一般编辑器都支持换行符的转换，以 VSCode 为例：
>
> ​![](https://image.peterjxl.com/blog/image-20221210221015-yuh49o9.png)​

‍

‍

‍

‍

‍

## 参考

本文主要参考了以下博客，非常感谢他们：

[回车和换行 - 阮一峰的网络日志](https://www.ruanyifeng.com/blog/2006/04/post_213.html)：参考并修改了下文字排版、添加了自己的说明

[CR, LF, CR/LF 回车 换行 - Prayer - C++ 博客](http://www.cppblog.com/prayer/archive/2009/08/19/93854.html)

‍
