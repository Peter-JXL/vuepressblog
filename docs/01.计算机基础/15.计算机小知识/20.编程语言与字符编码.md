---
title: ç¼–ç¨‹è¯­è¨€ä¸å­—ç¬¦ç¼–ç 
date: 2022-12-21 09:14:36
permalink: /literacy/character-encoding-program-language/
categories:
  - è®¡ç®—æœºåŸºç¡€
  - è®¡ç®—æœºå°çŸ¥è¯†
tags:
  - 
---


# 20.ç¼–ç¨‹è¯­è¨€ä¸å­—ç¬¦ç¼–ç 

ã€€ã€€â€![](https://image.peterjxl.com/blog/saber.jpg)

èŠèŠåœ¨ç¼–ç¨‹è¯­è¨€ä¸­çš„å­—ç¬¦ï¼Œä¾‹å¦‚Java

<!-- more -->

ã€€ã€€â€

## ä¸€ä¸ªå­—ç¬¦å å¤šå°‘ä¸ªå­—èŠ‚ï¼Ÿ

ã€€ã€€å¾—çœ‹æƒ…å†µï¼Œä¸åŒç¼–ç ä¸‹æƒ…å†µä¸åŒã€‚è¿™é‡Œå¼•ç”¨[ è‚–å›½æ ‹](https://www.zhihu.com/question/27562173/answer/76208352) å¤§ä½¬çš„å›ç­”ï¼š

> å…·ä½“åœ°è®²ï¼Œè„±ç¦»å…·ä½“çš„ç¼–ç è°ˆæŸä¸ªå­—ç¬¦å å‡ ä¸ªå­—èŠ‚æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚
>
> å°±å¥½æ¯”æœ‰ä¸€ä¸ªæŠ½è±¡çš„æ•´æ•°â€œ42â€ï¼Œä½ è¯´å®ƒå å‡ ä¸ªå­—èŠ‚ï¼Ÿè¿™å¾—å…·ä½“çœ‹ä½ æ˜¯ç”¨ byteï¼Œshortï¼Œintï¼Œè¿˜æ˜¯ long æ¥å­˜å®ƒã€‚ç”¨ byte å­˜å°±å ä¸€å­—èŠ‚ï¼Œç”¨ short å­˜å°±å ä¸¤å­—èŠ‚ï¼Œint é€šå¸¸æ˜¯å››å­—èŠ‚ï¼Œlong é€šå¸¸å…«å­—èŠ‚ã€‚å½“ç„¶ï¼Œå¦‚æœä½ ç”¨ byteï¼Œå—é™äºå®ƒæœ‰é™çš„ä½æ•°ï¼Œæœ‰äº›æ•°å®ƒæ˜¯å­˜ä¸äº†çš„ï¼Œæ¯”å¦‚ 256 å°±æ— æ³•æ”¾åœ¨ä¸€ä¸ª byte é‡Œäº†ã€‚å­—ç¬¦æ˜¯åŒæ ·çš„é“ç†ï¼Œå¦‚æœä½ æƒ³è°ˆâ€œå å‡ ä¸ªå­—èŠ‚â€ï¼Œå°±è¦å…ˆæŠŠç¼–ç è¯´æ¸…æ¥šã€‚
>
> åŒä¸€ä¸ªå­—ç¬¦åœ¨ä¸åŒçš„ç¼–ç ä¸‹å¯èƒ½å ä¸åŒçš„å­—èŠ‚ã€‚
>
> å°±ä»¥ä½ ä¸¾çš„â€œå­—â€å­—ä¸ºä¾‹ï¼Œâ€œå­—â€åœ¨ GBK ç¼–ç ä¸‹å  2 å­—èŠ‚ï¼Œåœ¨ UTF-16 ç¼–ç ä¸‹ä¹Ÿå  2 å­—èŠ‚ï¼Œåœ¨ UTF-8 ç¼–ç ä¸‹å  3 å­—èŠ‚ï¼Œåœ¨ UTF-32 ç¼–ç ä¸‹å  4 å­—èŠ‚ã€‚
>
> ä¸åŒçš„å­—ç¬¦åœ¨åŒä¸€ä¸ªç¼–ç ä¸‹ä¹Ÿå¯èƒ½å ä¸åŒçš„å­—èŠ‚ã€‚
>
> â€œå­—â€åœ¨ UTF-8 ç¼–ç ä¸‹å 3å­—èŠ‚ï¼Œè€Œâ€œAâ€åœ¨ UTF-8 ç¼–ç ä¸‹å  1 å­—èŠ‚ã€‚ï¼ˆå› ä¸º UTF-8 æ˜¯å˜é•¿ç¼–ç ï¼‰

ã€€ã€€â€

ã€€ã€€â€

## Javaä¸­çš„å­—ç¬¦ä¸²

ã€€ã€€å¯¹äºStringç±»å‹ï¼Œæœ‰è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼š`getBytes()`â€‹ï¼Œå…¶å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬åŒ–ä¸ºByteåºåˆ—ï¼Œå¹¶å­˜å‚¨åˆ°æ–°çš„`byte[]`â€‹æ•°ç»„

```java
    String str2 = "abcdefg";
    byte[] b = str2.getBytes();
    for(int i = 0; i < b.length; i++){
      System.out.println(b[i]); //è¾“å‡º97.98.99.100...103ï¼Œ å°±æ˜¯abcdefgçš„ASCIIç 
  
}
```

ã€€ã€€â€

ã€€ã€€â€

ã€€ã€€é—®ä¸ªé¢è¯•é¢˜ï¼š`new String("å­—").getBytes().length`â€‹çš„å€¼æ˜¯å¤šå°‘ï¼Ÿè¿˜æ˜¯ä¸Šé¢æåˆ°çš„é‚£å¥è¯ï¼Œå¾—çœ‹ç¼–ç ã€‚

ã€€ã€€åœ¨UTF8ä¸‹ï¼Œ`"å­—"`â€‹å 3ä¸ªï¼› è€Œåœ¨GBKä¸‹ï¼Œä¸€ä¸ªæ±‰å­—å 2ä¸ªå­—èŠ‚ï¼›å¦‚æœ`getBytes()`â€‹æ²¡æœ‰ä¼ å‚ï¼Œé‚£ä¹ˆé»˜è®¤ä½¿ç”¨æ“ä½œç³»ç»Ÿç¼–ç ï¼Œé€šå¸¸ï¼ŒWindows ç³»ç»Ÿä¸‹æ˜¯ GBKï¼ŒLinux å’Œ Mac æ˜¯ UTF-8.

```java
String str = "ä¸¥";
System.out.println("str.getBytes().length: "+ str.getBytes().length);
System.out.println("str.getBytes(\"GBK\").length: "+ str.getBytes("GBK").length);
System.out.println("str.getBytes(\"UTF-8\").length: "+ str.getBytes("UTF-8").length);
```

ã€€ã€€â€

ã€€ã€€ç¼–è¯‘å’Œè¿è¡Œç»“æœï¼š

```java
str.getBytes().length: 2
str.getBytes("GBK").length: 2
str.getBytes("UTF-8").length: 3
```

ã€€ã€€æ³¨æ„äº‹é¡¹ï¼š

1. å¯ä»¥åœ¨å¯åŠ¨JVMæ—¶è®¾ç½®ä¸€ä¸ªé»˜è®¤ç¼–ç ï¼Œä¾‹å¦‚ï¼š`java -Dfile.encoding=GBK Main`â€‹ã€‚ä¸è¿‡å¦‚æœä½ åœ¨ä»£ç é‡Œè¿˜æ˜¯æ˜¾ç¤ºçš„æŒ‡å®šäº†ç¼–ç ï¼Œè¿˜æ˜¯ä»¥æŒ‡å®šç¼–ç ä¸ºå‡†ï¼›
2. å¦‚æœä½ ç”¨IDEæ¥è¿è¡Œä»£ç ï¼Œå¹¶ä¸”è®¾ç½®äº†å·¥ç¨‹çš„é»˜è®¤ç¼–ç æ˜¯UTF-8ï¼Œé‚£ä¹ˆæ­¤æ—¶è¿è¡Œç¨‹åºçš„æ—¶å€™ä¼šåŠ ä¸Š`-Dfile.encoding=UTF-8`â€‹ å‚æ•°ã€‚
3. ç”±äºå—å¯åŠ¨å‚æ•°åŠæ‰€åœ¨æ“ä½œç³»ç»Ÿç¯å¢ƒçš„å½±å“ï¼Œä¸å¸¦å‚æ•°çš„ getBytes æ–¹æ³•é€šå¸¸æ˜¯ä¸å»ºè®®ä½¿ç”¨çš„ï¼Œæœ€å¥½æ˜¯æ˜¾å¼åœ°æŒ‡å®šå‚æ•°ä»¥æ­¤è·å¾—ç¨³å®šçš„é¢„æœŸè¡Œä¸ºã€‚

ã€€ã€€â€

## charç±»å‹

ã€€ã€€Javaè¯­è¨€è§„èŒƒè§„å®šï¼ŒJavaçš„charç±»å‹æ˜¯UTF-16çš„code unitï¼Œä¹Ÿå°±æ˜¯ä¸€å®šæ˜¯16ä½ï¼ˆ2å­—èŠ‚ï¼‰ï¼›

> [å®˜æ–¹æ–‡æ¡£](https://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.1)ï¼š `char`â€‹, whose values are 16-bit unsigned integers representing UTF-16 code units ([Â§3.1](https://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.1 "3.1.Â Unicode")).

ã€€ã€€å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨Javaè®¾è®¡ä¹‹åˆï¼ŒUTF-16è¿˜æ˜¯å®šé•¿ç¼–ç çš„ï¼Œä½†æ˜¯éšç€Unicodeå­—ç¬¦çš„å¢å¤šï¼ŒUTF-16å°±æ”¹ä¸ºå˜é•¿ç¼–ç äº†ï¼ˆ2ä¸ªå­—èŠ‚æˆ–4ä¸ªå­—èŠ‚ï¼‰ã€‚ æ‰€ä»¥char ä¸­åªèƒ½æ”¾ UTF-16 ç¼–ç ä¸‹åªå  2 å­—èŠ‚çš„é‚£äº›å­—ç¬¦ï¼Œå¦‚æœä¸€ä¸ªå­—ç¬¦åœ¨ UTF-16 ç¼–ç ä¸‹å  4 å­—èŠ‚ï¼Œæ˜¾ç„¶å®ƒæ˜¯ä¸èƒ½æ”¾åˆ° char ä¸­çš„ã€‚

ã€€ã€€â€

ã€€ã€€â€

ã€€ã€€â€

## Pythonä¸‹çš„å­—ç¬¦ç¼–ç 

ã€€ã€€Python2é»˜è®¤ç”¨çš„ç¼–ç æ˜¯ASCIIï¼ŒPython3é»˜è®¤ç”¨çš„æ˜¯UTF8

ã€€ã€€åˆ†åˆ«ä½¿ç”¨len("ä½ å¥½")  åœ¨Python3å¾—åˆ°çš„ç»“æœæ˜¯2ï¼Œåœ¨Python2å¾—åˆ°çš„ç»“æœæ˜¯6ï¼ˆ6ä¸ªå­—èŠ‚ï¼‰

ã€€ã€€â€

ã€€ã€€â€

ã€€ã€€â€

## Javaä¸­çš„`String.length()`â€‹

ã€€ã€€åœ¨Javaä¸­ï¼Œå¯ä»¥é€šè¿‡`String.length()`â€‹ è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é‚£ä¹ˆè¿™ä¸ªé•¿åº¦æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹çœ‹`length()`â€‹çš„æ³¨é‡Šå’Œæºç ï¼š

```java
/**
 * Returns the length of this string.
 * The length is equal to the number of Unicode code units in the string.
 *
 * @return  the length of the sequence of characters represented by this object.
 */
public int length() {
    return value.length;
}
```

ã€€ã€€æ³¨é‡Šé‡Œè¯´ï¼Œä¼šè¿”å›å­—ç¬¦ä¸²ä¸­Unicode unitçš„æ•°é‡ã€‚åœ¨Javaä¸­ï¼Œä½¿ç”¨çš„æ˜¯UTF-16ï¼Œå› æ­¤è¿™ä¸ªæ–¹æ³•çš„åŠŸèƒ½å¯ä»¥è§£é‡Šä¸ºï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™ä¸€é•¿åº¦ç­‰äºå­—ç¬¦ä¸²ä¸­çš„UTF-16çš„ä»£ç å•å…ƒçš„æ•°ç›®ã€‚

ã€€ã€€ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªå­—ç¬¦ä½¿ç”¨4ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆ`String.length()`â€‹é•¿åº¦æ˜¯2ï¼

ã€€ã€€â€

ã€€ã€€æˆ‘ä»¬æ¥æµ‹è¯•ä¸‹

```java
public class TestStringLength {
  public static void main(String[] args) {
    String str = "A";
    System.out.println(str.length());

    String str2 = "ğŸ˜€";
    System.out.println(str2.length());
  }
}
```

ã€€ã€€å¯¹äºå¤§å¤šæ•°emojiè¡¨æƒ…æ¥è¯´ï¼Œå…¶ç ç‚¹éƒ½æ¯”è¾ƒå¤§ï¼Œå¾—ç”¨4ä¸ªå­—èŠ‚ï¼Œå› æ­¤åœ¨UTF-16ä¸­å°±å¾—ç”¨2ä¸ªå­—èŠ‚ï¼Œå› æ­¤ç»“æœåˆ†åˆ«è¾“å‡º1,2

> ä¸ä¼šè¾“å…¥emojiçš„å¯ä»¥å‚è€ƒæˆ‘çš„åšå®¢ï¼š[è¾“å…¥æ³•çš„æŠ€å·§ ](https://www.peterjxl.com/typewriting/typewriting-tips/)

ã€€ã€€â€

ã€€ã€€è¡¥å……ï¼š`String.length()`â€‹è¿”å›çš„æ˜¯`value.length`â€‹ï¼Œè¿™ä¸ªvalueæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯ä¸€ä¸ªcharæ•°ç»„ï¼Œå‰é¢æˆ‘ä»¬ä¹Ÿè®²è¿‡Javaçš„charç±»å‹æ˜¯UTF-16çš„code unitï¼Œä¹Ÿå°±æ˜¯ä¸€å®šæ˜¯16ä½ï¼ˆ2å­—èŠ‚ï¼‰

```java
 private final char value[];
```

ã€€ã€€â€

ã€€ã€€â€

## â€‹`String.codePointCount()`â€‹

ã€€ã€€é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•ç»Ÿè®¡å­—ç¬¦ä¸²æœ‰å‡ ä¸ªå­—ç¬¦å‘¢ï¼Ÿå¯ä»¥ç”¨â€‹`String.codePointCount()`â€‹â€‹

ã€€ã€€æ–‡æ¡£è¯´æ˜ï¼šè¿”å›æŒ‡å®šå­—ç¬¦åºåˆ—çš„æ–‡æœ¬èŒƒå›´å†…çš„ Unicode ä»£ç ç‚¹æ•°é‡ã€‚

```java
public class TestStringLength {
  public static void main(String[] args) {
    String str2 = "ğŸ˜‚";
    System.out.println(str2.length());
    System.out.println(str2.codePointCount(0,str2.length())); //è¾“å‡º1
  }
}
```



## ä»£ç 

ã€€ã€€ç›¸å…³ä»£ç å·²ä¸Šä¼ åˆ°Giteeï¼š[01.JavaSE/05.OOP/15.character Â· å°æ—/LearnJava - ç äº‘ - å¼€æºä¸­å›½](https://gitee.com/peterjxl/LearnJava/tree/master/01.JavaSE/05.OOP/15.character)

ã€€ã€€â€

## å‚è€ƒ

ã€€ã€€[Java è¯­è¨€ä¸­ä¸€ä¸ªå­—ç¬¦å å‡ ä¸ªå­—èŠ‚ï¼Ÿ - çŸ¥ä¹](https://www.zhihu.com/question/27562173/answer/37188642)

ã€€ã€€æœ¬æ–‡ä¸»è¦å‚è€ƒäº†[è‚–å›½æ ‹](https://www.zhihu.com/question/27562173/answer/76208352) å¤§ä½¬çš„å›ç­”ï¼Œæ ¹æ®è‡ªå·±çš„æµ‹è¯•è€Œæˆ

ã€€ã€€â€
